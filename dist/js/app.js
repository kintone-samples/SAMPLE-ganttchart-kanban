!function(){var e,t={42236:function(e,t,n){"use strict";var r=n(39441),a=n.n(r),o=n(58971),i=n.n(o),l=n(38134),c=n.n(l),u=n(96540),d=n(5338),s=n(40961),p=n(56337),f=n(78995),v=n(17201),m=n.n(v),g=n(94181),w=n.n(g),h=n(2219),y=(n(26453),function(e){var t=e.onViewModeChange;return u.createElement(u.Fragment,null,u.createElement(p.Ay.Group,{defaultValue:h.n.Day,buttonStyle:"solid",onChange:function(e){return t(e.target.value)}},u.createElement(p.Ay.Button,{value:h.n.QuarterDay},h.n.QuarterDay),u.createElement(p.Ay.Button,{value:h.n.HalfDay},h.n.HalfDay),u.createElement(p.Ay.Button,{value:h.n.Day},h.n.Day),u.createElement(p.Ay.Button,{value:h.n.Week},h.n.Week),u.createElement(p.Ay.Button,{value:h.n.Month},h.n.Month)))}),E=n(34963),k=n(66771),A=n.n(k),b=n(44828),C=n.n(b),D=n(24918),S=n(35584),x=n.n(S),O=function(e){return(new D.KintoneRestAPIClient).record.getRecords({app:kintone.app.getId(),query:"".concat(e||""," order by $id asc")})},M=function(){return(new D.KintoneRestAPIClient).app.getFormFields({app:kintone.app.getId()})},F=function(){var e=(0,E.A)(C().mark(function e(t,n){return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,(new D.KintoneRestAPIClient).record.updateRecord({app:kintone.app.getId(),id:t,record:{status:{value:n}}});case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=(0,E.A)(C().mark(function e(t,n,r){return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,(new D.KintoneRestAPIClient).record.updateRecord({app:kintone.app.getId(),id:t,record:{startDate:{value:n},endDate:{value:r}}});case 1:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),B=function(){var e=(0,E.A)(C().mark(function e(t,n){var r,o,i,l,c,u;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,kintone.Promise.all([M(),O(n)]);case 1:r=e.sent,o=(0,f.A)(r,2),i=o[0],l=o[1],c=new(a()),u=new(a()),A()(i.properties.type.options).forEach(function(e){c.set(e,x()(e))}),A()(i.properties.status.options).forEach(function(e){u.set(e,i.properties.status.options[e].index)}),t(l.records,u,c);case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),I=n(428),z=n(83567),P=function(e){var t=e.query,n=void 0===t?"":t,r=u.useState(h.n.Day),a=(0,f.A)(r,2),o=a[0],i=a[1],l=u.useState(),c=(0,f.A)(l,2),d=c[0],s=c[1],p=u.useState(!0),v=(0,f.A)(p,2),g=v[0],E=v[1],k=60;o===h.n.Month?k=300:o===h.n.Week&&(k=250);(0,u.useEffect)(function(){B(b,n)},[]);var A,b=function(e,t,n){0===e.length?E(!1):s(w()(e).call(e,function(e){return{id:e.$id.value,name:e.summary.value,start:new Date(e.startDate.value+"T00:00:00.000+09:00"),end:new Date(e.endDate.value+"T23:59:59.000+09:00"),progress:Math.ceil(100*(t.get(e.status.value)||0)/Math.max(t.size-1,1)),styles:{progressColor:n.get(e.type.value)||"#ff9e0d",progressSelectedColor:"#ff9e0d"},dependencies:e.parent.value?[e.parent.value]:[],type:"task"}}))};return A=d&&d.length>0?u.createElement("div",null,u.createElement(y,{onViewModeChange:function(e){return i(e)}}),u.createElement(h.N,{tasks:d,viewMode:o,onDateChange:function(e){var t=new Date(e.start.getTime()-60*e.start.getTimezoneOffset()*1e3).toISOString().split("T")[0],n=new Date(e.end.getTime()-60*e.end.getTimezoneOffset()*1e3).toISOString().split("T")[0];T(e.id,t,n)},onDoubleClick:function(e){var t=window.location.protocol+"//"+window.location.host+window.location.pathname+"show#record="+e.id;window.location.assign(m()(t).call(t,"showshow","show"))},listCellWidth:"155px",columnWidth:k,todayColor:"#FCFF19"})):g?u.createElement("div",{className:"center"},u.createElement(I.A,{size:"large",tip:"Loading..."})):u.createElement(z.Ay,{title:"No data"}),u.createElement(u.Fragment,null,A)},j=n(96630),G=n(40312),H=n(26898),$=n(66270),R=G.A.Meta,K=function(e){var t;return u.createElement(H.A.Group,{maxCount:2,size:"large",maxStyle:{color:"#f56a00",backgroundColor:"#fde3cf"}},w()(t=e.assignee.value).call(t,function(e){return u.createElement(H.A,{style:{backgroundColor:"#15dad2"},key:e.code},e.name)}))},N=function(e){var t;return u.createElement(G.A,{extra:u.createElement($.A,{color:e.labelColor},e.label),style:{width:300},title:e.title,onClick:e.onClick},u.createElement(R,{avatar:u.createElement(K,{assignee:e.assignee}),title:i()(t="".concat(e.startDate.substring(5),"~")).call(t,e.endDate.substring(5)),description:e.description}))},W=function(){var e=u.useState(),t=(0,f.A)(e,2),n=t[0],r=t[1],a=u.useState(!0),o=(0,f.A)(a,2),i=o[0],l=o[1],c=function(e,t,n){if(0===e.length)l(!1);else{var a=new Array(t.size);t.forEach(function(e,t){a[e]={id:t,title:t,cards:new Array}}),e.forEach(function(e){return a[t.get(e.status.value)].cards.push({id:e.$id.value,title:e.summary.value,label:e.type.value,labelColor:n.get(e.type.value),description:e.detail.value,assignee:e.assignee,startDate:e.startDate.value,endDate:e.endDate.value})}),r({lanes:a})}};(0,u.useEffect)(function(){B(c,kintone.app.getQueryCondition()||void 0)},[]);var d;return d=n?u.createElement(j.Ay,{data:n,draggable:!0,onCardClick:function(e){var t=window.location.protocol+"//"+window.location.host+window.location.pathname+"show#record="+e;window.location.assign(t)},hideCardDeleteIcon:!0,handleDragEnd:function(e,t,n){F(e,n)},style:{padding:"30px 20px",backgroundColor:"#5F9AF8"},components:{Card:N}}):i?u.createElement("div",{className:"center"},u.createElement(I.A,{size:"large",tip:"Loading..."})):u.createElement(z.Ay,{title:"No data"}),u.createElement(u.Fragment,null,d)},q=function(e){return e.Gantt="Gantt",e.Board="Kanban",e}({}),Q=function(){return(0,u.useEffect)(function(){s.render(u.createElement(W,null),kintone.app.getHeaderSpaceElement())},[]),u.createElement(u.Fragment,null,u.createElement(p.Ay.Group,{defaultValue:q.Board,buttonStyle:"solid",size:"large",onChange:function(e){e.target.value===q.Gantt?s.render(u.createElement(P,{query:kintone.app.getQueryCondition()||void 0}),kintone.app.getHeaderSpaceElement()):s.render(u.createElement(W,null),kintone.app.getHeaderSpaceElement())}},u.createElement(p.Ay.Button,{value:q.Gantt},q.Gantt),u.createElement(p.Ay.Button,{value:q.Board},q.Board)))},V=n(56401),_=n(71167),L=n(34172),J=function(e){var t=e.id,n=void 0===t?"":t;return u.createElement(V.A,{title:"add sub task"},u.createElement(_.A,{type:"primary",shape:"circle",icon:u.createElement(L.A,null),size:"large",onClick:function(){if(n){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+"edit?pid="+n;window.location.assign(m()(e).call(e,"showedit","edit"))}}}))},U=new(a());function X(e,t){U.has(e)||U.set(e,(0,d.H)(e)),U.get(e).render(t)}kintone.events.on("app.record.index.show",function(e){var t=kintone.app.getHeaderMenuSpaceElement();return t?(X(t,u.createElement(Q,null)),e):e}),kintone.events.on("app.record.detail.show",function(e){var t,n=i()(t="parent = ".concat(e.record.$id.value," or $id= ")).call(t,e.record.$id.value);e.record.parent.value&&(n+=" or $id = ".concat(e.record.parent.value));var r=kintone.app.getHeaderMenuSpaceElement();if(!r)return e;X(r,u.createElement(P,{query:n}));var a=kintone.app.record.getSpaceElement("addSub");return a?(X(a,u.createElement(J,{id:e.record.$id.value})),e):e}),kintone.events.on("app.record.create.show",function(e){var t=window.location.search,n=new(c())(t).get("pid");return n&&(e.record.parent.value=n),e})},42634:function(){}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.m=t,e=[],r.O=function(t,n,a,o){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],o=e[d][2];for(var l=!0,c=0;c<n.length;c++)(!1&o||i>=o)&&Object.keys(r.O).every(function(e){return r.O[e](n[c])})?n.splice(c--,1):(l=!1,o<i&&(i=o));if(l){e.splice(d--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,a,o]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,o,i=n[0],l=n[1],c=n[2],u=0;if(i.some(function(t){return 0!==e[t]})){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(c)var d=c(r)}for(t&&t(n);u<i.length;u++)o=i[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(d)},n=self.webpackChunkkpm=self.webpackChunkkpm||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),r.nc=void 0;var a=r.O(void 0,[223],function(){return r(42236)});a=r.O(a)}();